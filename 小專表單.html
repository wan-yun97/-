<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>預約諮詢</title>
    <link rel="icon" href="./img/moon-stars-fill.svg">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="./CSS/navbarStyle.css">
    <style>
        #search {
            line-height: 25px;
            border-radius: 4px;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
            font-size: 25px;
        }

        #search:hover {
            color: rgb(177, 102, 102);
            background-color: #ddd;

        }

        input[type="radio"] {
            cursor: pointer;
        }

        /* 20. :valid 驗證通過時的樣式設定 */
        input[type="email"]:valid,
        /* input[type="text"]:valid, */
        input[type="tel"]:valid {
            background-color: white;
        }

        /* 21. :invalid 驗證不通過時的樣式設定 */
        input[type="email"]:invalid,
        input[type="text"]:invalid,
        input[type="tel"]:invalid {
            background-color: rgb(200, 199, 199);
        }

        textarea {
            resize: vertical;
            /* 允許垂直縮放 */
        }

        fieldset .submit {
            border-style: none;
            width: 10em;
            height: 3em;
            margin: -1em auto 1em 18em;
        }

        .submit {
            text-align: center;
        }

        fieldset {
            width: 75%;
            text-align: left;
            margin-left: auto;
            margin-right: auto;
            font-size: 22px;
            color: #fefdfd;
            font-weight: 500;
        }

        #inside {
            width: 75%;
            text-align: left;
            margin-left: auto;
            margin-right: auto;
            font-size: 20px;
            color: #fefdfd;
            font-weight: 500;
        }

        /* #explain {
            width: 100%;
            height: 150px;
            padding: 12px 20px;
            box-sizing: border-box;
            border: 2px solid #ccc;
            border-radius: 4px;
            background-color: #f8f8f8;
            resize: none;
        } */


        /* The Modal (background) */
        .modal {
            display: none;
            /* Hidden by default */
            position: fixed;
            z-index: 1;
            /* Sit on top */
            padding-top: 100px;
            /* Location of the box */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgba(0, 0, 0, 0.4);
            /* Black w/ opacity */
        }

        /* The Modal (background) */
        .modal {
            display: none;
            /* Hidden by default */
            position: fixed;
            /* Stay in place */
            z-index: 1;
            /* Sit on top */
            padding-top: 100px;
            /* Location of the box */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgb(0, 0, 0);
            /* Fallback color */
            background-color: rgba(0, 0, 0, 0.4);
            /* Black w/ opacity */
        }

        /* Modal Content */
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }

        /* The Close Button */
        .close {
            color: #aaaaaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }

        .button-container {
            display: flex;
            justify-content: flex-end;
            /* 讓按鈕靠右對齊 */
            padding-top: 10px;
            /* 與上方文字保持距離 */
        }

        #confirmSubmit {
            padding: 8px 16px;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }

        #confirmSubmit:hover {
            background-color: #0056b3;
        }


        @media (min-width: 768px) {
            .checkbox-group {
                flex-direction: row;
                /* 水平排列 */
                justify-content: flex-start;
                /* 靠左對齊 */
                margin-right: 15px;
                /* 每個選項之間的間隔 */
            }

            /* 使所有選項水平排列 */
            .checkbox-group-wrapper {
                display: flex;
                /* 使用 flexbox 來排列所有選項 */
                flex-wrap: wrap;
                /* 讓項目換行顯示 */
                gap: 20px;
                /* 選項之間的間距 */
            }
        }

        /* 響應式設計：螢幕寬度小於768px */
        @media (max-width: 768px) {
            form {
                width: 95%;
                /* 讓表單在小螢幕上能更好地適應 */
                padding: 10px;
            }

            fieldset {
                padding: 10px;
            }

            legend {
                font-size: 1.1em;
                /* 較小螢幕上減小字體 */
            }

            .submit {
                width: 20%;
                /* 按鈕寬度占滿螢幕 */
                padding: 15px;
                font-size: 18px;
            }

            /* 讓各個選項在縱向排列時更清晰 */
            label {
                display: block;
                margin-bottom: 2px;
            }

            /* 優化文字輸入框 */
            input[type="text"],
            input[type="email"],
            input[type="number"],
            input[type="tel"],
            textarea {
                margin-bottom: 10px;
            }

            /* 在小螢幕上讓某些區域垂直排列 */
            .radio-group,
            .checkbox-group {
                display: flex;
                flex-direction: column;
            }

            /* 調整各個問題區塊的樣式 */
            .radio-group input,
            .checkbox-group input {
                margin-right: 0;
                margin-bottom: 10px;
            }

            .textarea-group textarea {
                width: 100%;
                margin-bottom: 15px;
            }
        }



        @media (max-width: 480px) {
            .submit {
                padding: 20px;
                font-size: 20px;
            }

            legend {
                font-size: 1em;
            }
        }

        /* 包裝勾選框和文字的容器 */
        .checkbox-group {
            display: flex;
            align-items: center;
            /* 垂直居中對齊 */
            margin-bottom: 10px;
            /* 每個選項之間的間距 */
        }

        /* 讓勾選框與文字之間有一定的間距 */
        .checkbox-group input[type="checkbox"],
        .checkbox-group input[type="radio"] {
            margin-right: 10px;
            /* 讓勾選框與文字之間有些間距 */
        }

        /* 響應式設計：在較小的螢幕上仍能保持在一行 */
        @media (max-width: 768px) {
            .checkbox-group {
                flex-direction: row;
                /* 維持水平方向排列 */
            }
        }

        /* 在非常小的螢幕上（例如手機），也會保持同一行顯示 */
        @media (max-width: 480px) {
            .checkbox-group {
                flex-direction: row;
                /* 維持水平方向排列 */
            }
        }
    </style>
</head>

<body style="background-color: rgba(167, 156, 156, 0.956);margin: 0;">

    <div class="header">
        <div class="split" href="" style="color: rgb(127, 121, 121);"><i id="moon" class="bi bi-moon-stars-fill"></i>++
            Astrology & Tarot ++</div>
        <div class="nav-links">
            <a href="./小專.html#aboutMe">關於我</a>
            <a href="./小專.html#option">諮詢類別</a>
            <a href="./小專.html#operation">服務流程</a>
            <a href="./小專.html" class="active">回上頁</a>
            <div class="search">
                <input type="text" placeholder="Search..">
                <i id="search" class="bi bi-search"></i>
            </div>
        </div>
    </div>




    <h2 style="text-align: center;margin-top: 80px;font-size: 30px;margin-bottom: 50px;color: rgb(118, 98, 98);">預約諮詢表單
    </h2>
    <form>
        <fieldset>
            <legend>基本資料</legend>

            <label for="clientName">姓名：</label>
            <input type="text" id="userName">
            <div>
                出生指定性別：
                <div class="checkbox-group">
                    <input name="sex" type="radio" id="female">
                    <label for="female">女性</label>
                </div>

                <div class="checkbox-group">
                    <input name="sex" type="radio" id="male">
                    <label for="male">男性</label>
                </div>

                <div class="checkbox-group">
                    <input name="sex" type="radio" id="othersex">
                    <label for="othersex">其他</label>
                </div>
            </div>

            <br>
            <label for="userAge">年齡：</label>
            <input type="number" id="userAge">

            <label for="userPhone">電話(必填)：</label>
            <input type="tel" id="userPhone" pattern="[0-9]{10}" required>

            <label for="userMail">電子郵件(必填)：</label>
            <input type="email" id="userMail" required>



        </fieldset>
        <br><br>
        <fieldset>
            <legend>諮詢類別</legend>
            <div class="checkbox-group">
                <input name="category" type="radio" id="astrology">
                <label for="astrology">星盤諮詢</label>
            </div>


            <div class="checkbox-group">
                <input name="category" type="radio" id="tarot">
                <label for="tarot">塔羅諮詢</label>
            </div>
        </fieldset>
        <br><br>

        <fieldset>
            <legend>諮詢問題 </legend>
            <div class="checkbox-group">
                <input name="Quest" type="checkbox" id="career">
                <label for="career">職涯議題</label>
            </div>
            <div class="checkbox-group">
                <input name="Quest" type="checkbox" id="relationship">
                <label for="relationship">感情困擾</label>
            </div>
            <div class="checkbox-group">
                <input name="Quest" type="checkbox" id="interaction">
                <label for="interaction">人際、家庭困擾</label>
            </div>
            <div class="checkbox-group">
                <input name="Quest" type="checkbox" id="decision">
                <label for="decision">生涯抉擇</label>
            </div>
            <br>

            <br>
            <label for="advanced">諮詢進階說明：</label>
            <br>
            <textarea id="explain" rows="4" cols="50"></textarea>
        </fieldset>
        <br><br>
        <fieldset>
            <legend>諮詢預約偏好</legend>
            <div class="checkbox-group">
                <input name="preference" type="radio" id="person">
                <label for="person">實體諮詢</label>
            </div>
            <br>

            <fieldset id="inside" disabled>

                <div class="checkbox-group">
                    <input name="meet_at" type="radio" id="Starbucks">
                    <label for="Starbucks">Starbucks(南區門市)</label>
                </div>
                <div class="checkbox-group">
                    <input name="meet_at" type="radio" id="Louisa">
                    <label for="Louisa">路易莎(南區門市)</label>
                </div>
                <div class="checkbox-group">
                    <input name="meet_at" type="radio" id="otherRecommend">
                    <label for="otherRecommend">其他推薦</label>
                </div>

                <!-- 其他推薦的輸入框，預設 disabled -->
                <input type="text" id="customLocation" placeholder="請輸入門市名稱" disabled>
            </fieldset>

            <br><br>
            <div class="checkbox-group">
                <input name="preference" type="radio" id="online">
                <label for="online">線上諮詢(Google Meet)</label>
            </div>
        </fieldset>

        <br><br>
        <!-- <hr> -->
        <fieldset>
            <legend>方便安排諮詢之時間(請盡量勾選多個時段)</legend>
            <p>
                平日晚間19:00~21:00 <br> 假日上午時段10:00~12:00 午後時段14:00~16:00
            </p>
            <div class="checkbox-group">
                <input name="time" type="checkbox" id="Monday">
                <label for="Monday">週一晚間</label>
            </div>
            <div class="checkbox-group">
                <input name="time" type="checkbox" id="Tuesday">
                <label for="Tuesday">週二晚間</label>
            </div>
            <div class="checkbox-group">
                <input name="time" type="checkbox" id="Wednesday">
                <label for="Wednesday">週三晚間</label>
            </div>
            <div class="checkbox-group">
                <input name="time" type="checkbox" id="Thursday">
                <label for="Thursday">週四晚間</label>
            </div>
            <div class="checkbox-group">
                <input name="time" type="checkbox" id="Friday">
                <label for="Friday">週五晚間</label>
            </div>
            <br><br>
            <div class="checkbox-group">
                <input name="time" type="checkbox" id="SatMorn">
                <label for="SatMorn">週六上午</label>
            </div>
            <div class="checkbox-group">
                <input name="time" type="checkbox" id="Sataft">
                <label for="Sataft">週六午後</label>
            </div>
            <br><br>
            <div class="checkbox-group">
                <input name="time" type="checkbox" id="SunMorn">
                <label for="SunMorn">週日上午</label>
            </div>
            <div class="checkbox-group">
                <input name="time" type="checkbox" id="SunAft">
                <label for="SunAft">週日午後</label>
            </div>
            <br><br><br>
        </fieldset>
        <br>
        <div style="display: flex; justify-content: center;margin-top: 25px;">
            <button id="btnSubmit" name="btnSubmit" type="submit" class="submit"
                style="font-size: 16px; padding: 5px 15px;margin-bottom: 50px;">提交
            </button>
        </div>
    </form>
    <!-- The Modal -->
    <div id="myModal" class="modal">

        <!-- Modal content -->
        <div class="modal-content">
            <span class="close">&times;</span>
            <p>即將提交，請再次確認您的基本資料，謝謝您！</p>
            <button class="button-container" id="confirmSubmit">確定送出</button>
        </div>

    </div>

    <script>
        // Get the modal
        var modal = document.getElementById("myModal");

        // Get the button that opens the modal
        var btn = document.getElementById("btnSubmit");

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        var confirmBtn = document.getElementById("confirmSubmit"); // 確定送出的按鈕

        // When the user clicks the button, open the modal 
        btn.onclick = function () {
            modal.style.display = "block";
        }

        // When the user clicks on <span> (x), close the modal
        span.onclick = function () {
            modal.style.display = "none";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }


        function doChange(event) {
            localStorage.setItem(event.target.id, event.target.value);
        }
        // Set up event listeners for each input field
        document.getElementById("userName").onkeyup = doChange;
        document.getElementById("userPhone").onkeyup = doChange;
        document.getElementById("userMail").onkeyup = doChange;
        document.getElementById("explain").onkeyup = doChange;



        ["userName", "userPhone", "userMail", "explain"].forEach(id => {
            if (localStorage.getItem(id)) {
                document.getElementById(id).value = localStorage.getItem(id);
            }
        });
        function readAndShow() {
    // 讀取 localStorage 的資料並填入對應的 input 欄位
    ["userName", "userPhone", "userMail", "explain"].forEach(id => {
        if (localStorage.getItem(id)) {
            document.getElementById(id).value = localStorage.getItem(id);
        }
    });}
        

        // Call readAndShow function when the page is loaded
        window.onload = readAndShow;



        // document.forms[0].onsubmit = function () { localStorage.clear(); };


        document.forms[0].onsubmit = function (event) {
            event.preventDefault(); // 阻止表單提交
            modal.style.display = "block"; // 顯示模態視窗

            // 讓使用者確認後才清除 localStorage
            document.getElementById("confirmSubmit").onclick = function () {
                localStorage.clear();
                document.forms[0].submit(); // 這時才真正提交
            };
        };

        window.onload = function () {
            // 取得元素
            const personRadio = document.getElementById("person");
            const onlineRadio = document.getElementById("online");
            const otherRecommendRadio = document.getElementById("otherRecommend");
            const customLocation = document.getElementById("customLocation");
            const insideFieldset = document.getElementById("inside"); // fieldset (門市選擇區塊)

            if (!personRadio || !onlineRadio || !otherRecommendRadio || !customLocation || !insideFieldset) {
                console.error("某些元素未找到，請檢查 HTML 的 ID 或 name 是否正確");
                return;
            }

            // 監聽「實體諮詢」選項的變化
            function toggleStoreOptions() {
                if (personRadio.checked) {
                    insideFieldset.disabled = false; // 啟用 fieldset 內所有選項
                } else {
                    insideFieldset.disabled = true;
                    otherRecommendRadio.checked = false; // 取消選擇「其他推薦」
                    customLocation.disabled = true;
                    customLocation.value = ""; // 清空輸入框
                }
            }

            // 監聽「其他推薦」選項的變化
            function toggleCustomInput() {
                customLocation.disabled = !otherRecommendRadio.checked;
                if (!otherRecommendRadio.checked) {
                    customLocation.value = ""; // 清空輸入框
                }
            }

            // 讓使用者點擊輸入框時，自動選擇「其他推薦」與「實體諮詢」
            customLocation.addEventListener("focus", function () {
                personRadio.checked = true; // 自動選擇「實體諮詢」
                otherRecommendRadio.checked = true; // 自動選擇「其他推薦」

                toggleStoreOptions(); // 確保門市選項啟用
                toggleCustomInput(); // 確保輸入框啟用
            });

            // 綁定事件
            personRadio.addEventListener("change", toggleStoreOptions);
            onlineRadio.addEventListener("change", toggleStoreOptions);
            otherRecommendRadio.addEventListener("change", toggleCustomInput);

            // // 預先執行一次，確保正確狀態
            // toggleStoreOptions();
            // toggleCustomInput();
        }


    </script>
</body>

</html>